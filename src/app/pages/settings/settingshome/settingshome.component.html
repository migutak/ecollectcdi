<!--<ngx-spinner
  bdColor="rgba(51,51,51,0.8)"
  color="#fff"
  size="medium"
  type="ball-scale-multiple"
>
  <p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner>-->
<ng-progress #progressBar></ng-progress>
<app-panel [hidden]="showit">
    <div [hidden]="!showit" class="col-md-3">
        <div class="col-md-12">
            <button
                (click)="backtocollector()"
                class="btn btn-sm btn-primary"
                type="button"
            >
                Back to Collector Activity
            </button>
        </div>
    </div>
    <div>
        <div *ngIf="flaggedNotes?.length > 0" class="alert alert-danger m-b-0">
            <h6>
                <i class="fa fa-info-circle"></i> Kindly note this account has a
                flagged note
            </h6>
            <p>
                <button
                    *ngIf="flaggedNotes?.length > 0"
                    type="button"
                    class="btn btn-primary btn-xs"
                    (click)="collapse.toggle()"
                    [attr.aria-expanded]="isCollapsed"
                    aria-controls="collapseExample"
                >
                    View ({{ flaggedNotes?.length }})
                </button>
            </p>
        </div>
        <div class="btn-group">
            <button (click)="acc.expandAll()" class="btn btn-success">
                Expanel All Panels
            </button>
            <button (click)="acc.collapseAll()" class="btn btn-success">
                Collapse All Panels
            </button>
        </div>
        <div #collapse="ngbCollapse" [(ngbCollapse)]="!isCollapsed">
            <div class="card-accordion">
                <ngb-accordion
                    #acc="ngbAccordion"
                    [closeOthers]="false"
                    activeIds="ngb-panel-0"
                >
                    <ngx-skeleton-loader
                        *ngIf="loader"
                        [count]="7"
                        [theme]="{
                            width: '400px',
                            'border-radius': '0',
                            height: '15px',
                            'background-color': '#c8c7c7',
                            'margin-bottom': '10px'
                        }"
                    ></ngx-skeleton-loader>
                    <ngb-panel
                        type="light"
                        *ngFor="
                            let note of flaggedNotes
                                | paginate: { itemsPerPage: 10, currentPage: p }
                        "
                    >
                        <ng-template ngbPanelTitle>
                            <!--<span  placement="right" ngbTooltip="Click to View more Details"
                       [closeDelay]="500" class="text-inverse"><b>{{i+1}})</b> &nbsp;<b>{{ note.OWNER }}</b> {{ note.NOTESRC }} on Account
                  <b>{{ note.ACCNUMBER }}</b>   ({{ note.NOTEDATE | amTimeAgo }})  on
                  {{ note.NOTEDATE | date: 'medium' }}</span>-->
                            <span
                                placement="right"
                                ngbTooltip="Click to View more Details"
                                [closeDelay]="500"
                                class="text-inverse"
                            >
                                &nbsp;{{ note.owner }} {{ note.notesrc }} on
                                Account <b>{{ note.accnumber }}</b> on
                                {{ note.notedate }}
                            </span>
                            <span
                                placement="left"
                                ngbTooltip="Click to View more Details"
                                [closeDelay]="500"
                                style="float: right"
                                >More Details â–¼</span
                            >
                        </ng-template>
                        <ng-template ngbPanelContent>
                            <div class="row">
                                <div class="col-md-9">
                                    {{ note.notemade }}
                                </div>
                                <div class="col-md-3">
                                    <table class="table-responsive-sm">
                                        <tbody>
                                            <tr>
                                                <th>Reason for default:</th>
                                                <td>{{ note.reason }}</td>
                                            </tr>
                                            <tr>
                                                <th>Reason Detail:</th>
                                                <td>
                                                    {{ note.reasondetails }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Account Balance:</th>
                                                <td>{{ note.outsbalance }}</td>
                                            </tr>
                                            <tr>
                                                <th scope="row">
                                                    Total arrears:
                                                </th>
                                                <td>{{ note.totalarrears }}</td>
                                            </tr>
                                            <tr>
                                                <th scope="row">
                                                    Days in arrears:
                                                </th>
                                                <td colspan="2">
                                                    {{ note.daysinarrears }}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </ng-template>
                    </ngb-panel>
                </ngb-accordion>
            </div>
            <pagination-controls
                *ngIf="flaggedNotes?.length > 10"
                (pageChange)="p = $event"
            ></pagination-controls>
        </div>
        <!--      <p>Kindly Download and Use the provided Template to Upload</p>-->

        <div class="card-header">
            <strong>Collector activity </strong> capture
            <!--      <button (click)="CollectoractionSteps()" class="btn btn-primary">SHOW ME STEPS</button>-->
        </div>

        <form
            (ngSubmit)="onSubmit()"
            [formGroup]="actionForm"
            autocomplete="off"
            novalidate
        >
            <div *ngIf="!showit" class="card-body">
                <!--        Collector action start-->
                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">Collector action</div>
                    <div class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <label for="collectoraction"></label>
                            <ng-select
                                [loading]="ngselectloader"
                                (ngModelChange)="
                                    changeAction(
                                        actionForm.value.collectoraction
                                    )
                                "
                                *ngIf="!loader"
                                [ngClass]="{
                                    'ng-invalid': f.collectoraction.errors
                                }"
                                placeholder="Select Collector Action"
                                formControlName="collectoraction"
                                id="collectoraction"
                                name="collectoraction"
                            >
                                <!--              <ng-option value=''>Please select</ng-option>-->
                                <ng-option
                                    [ngClass]="{
                                        'ng-invalid': f.collectoraction.errors
                                    }"
                                    *ngFor="let action of collectoraction"
                                    [value]="[
                                        {
                                            id: action.id,
                                            colid: action.collectoractionid,
                                            cola: action.collectoraction
                                        }
                                    ]"
                                >
                                    {{ action.collectoraction }}
                                </ng-option>
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        collector action end-->

                <!--party start-->
                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!f.party.disabled && !loader" class="col-md-3">
                        Party contacted
                    </div>
                    <div *ngIf="!f.party.disabled" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                [loading]="ngselectloader"
                                (ngModelChange)="changeParty(actionForm.value)"
                                formControlName="party"
                                id="party"
                                placeholder="Select Party"
                            >
                                <ng-option
                                    *ngFor="let p of party"
                                    [value]="[{ exd: p.party, id: p.partyid }]"
                                    >{{ p.party }}</ng-option
                                >
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        party end-->

                <!--Reason for Default start-->

                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">
                        Reason for default
                    </div>
                    <div *ngIf="!loader" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <!--              <p    placement="top" ngbTooltip="This is Disabled. Check the box to edit this"   [closeDelay]="500">&nbsp;</p>-->
                            <ng-template #tipContent>
                                <p
                                    *ngIf="
                                        this.actionForm.controls.reason.disabled
                                    "
                                >
                                    This is Disabled. Check the box to edit this
                                </p>
                            </ng-template>
                            <ng-select
                                [ngbTooltip]="tipContent"
                                [loading]="ngselectloader"
                                (change)="
                                    onChangeExcuse($event, actionForm.value)
                                "
                                *ngIf="!loader"
                                formControlName="reason"
                                placeholder="Select Reason"
                            >
                                <ng-option
                                    *ngFor="let thing of mainReason"
                                    [value]="[
                                        { ex: thing.excuse, id: thing.id }
                                    ]"
                                    id="reason"
                                >
                                    {{ thing.excuse }}</ng-option
                                >
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        Reason for Default end-->

                <!--        Reason for Default Detailed Start-->

                <div class="row" style="padding-top: 20px">
                    <div
                        *ngIf="!actionForm.controls['reason'].invalid"
                        class="col-md-3"
                    >
                        Detail Reason for Default
                    </div>
                    <div
                        *ngIf="!actionForm.controls['reason'].invalid"
                        class="col-md-9"
                    >
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                [loading]="ngselectloader"
                                formControlName="reasondetails"
                                id="reasondetails"
                                placeholder="Select Reason Details"
                            >
                                <ng-option
                                    *ngFor="let exdtls of subReason"
                                    [value]="[
                                        {
                                            exd: exdtls.excusedetails,
                                            id: exdtls.excuseid
                                        }
                                    ]"
                                    >{{ exdtls.excusedetails }}</ng-option
                                >
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        Reason for Default Detailed end-->

                <!--        previous reason start-->

                <div *ngIf="display" class="row" style="padding-top: 20px">
                    <div class="col-md-3">Previous Reason</div>
                    <div class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <input
                                formControlName="preason"
                                [ngClass]="{ 'is-invalid': f.preason.errors }"
                                class="form-control"
                                id="preason"
                                name="preason"
                                type="text"
                            />
                        </div>
                    </div>
                </div>

                <!--        previous reasons end-->

                <!--        checkbox start-->

                <div *ngIf="showcheckbox" class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-9">
                        <div class="col-md-3 col-form-label">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <div
                                *ngIf="!loader"
                                class="checkbox checkbox-css checkbox-inline"
                            >
                                <input
                                    [checked]="false"
                                    (click)="changealert($event)"
                                    formControlName="checkreason"
                                    id="checkreason"
                                    name="checkreason"
                                    type="checkbox"
                                />
                                <label for="checkreason"
                                    >Change this Reason</label
                                >
                                <p *ngIf="display" class="text-danger">
                                    You are strongly advised not to edit unless
                                    necessary
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!--        checkbox end-->

                <!--        remedial checkbox start-->

                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-9">
                        <div class="col-md-3 col-form-label">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <div
                                *ngIf="!loader"
                                class="checkbox checkbox-css checkbox-inline"
                            >
                                <input
                                    [checked]="false"
                                    (click)="enablerestructure($event)"
                                    formControlName="enablerestr"
                                    id="enablerestr"
                                    name="enablerestr"
                                    type="checkbox"
                                />
                                <label for="enablerestr"
                                    >Enable restructure</label
                                >
                                <!--                <p *ngIf='display' class='text-danger'>You are strongly advised not to edit unless necessary</p>-->
                            </div>
                        </div>
                    </div>
                </div>

                <!--        remedial checkbox end-->

                <!--        proposed remedial product start-->

                <div *ngIf="enablerest" class="row" style="padding-top: 20px">
                    <div class="col-md-3">Proposed Remedial Product</div>
                    <div class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                id="proposedproduct"
                                formControlName="proposedproduct"
                                placeholder="Select remedial product"
                            >
                                <ng-option value="Restructure"
                                    >Restructure</ng-option
                                >
                                <ng-option value="Top up">Top up</ng-option>
                                <ng-option value="Interest Concession"
                                    >Interest Concession</ng-option
                                >
                                <ng-option
                                    value="Debt discount (Full & final Settlement)"
                                    >Debt discount (Full & final Settlement)
                                </ng-option>
                                <ng-option value="Insurance claim"
                                    >Insurance claim</ng-option
                                >
                                <ng-option value="Foreclosure"
                                    >Foreclosure</ng-option
                                >
                                <ng-option value="Take over"
                                    >Take over</ng-option
                                >
                                <ng-option value="Write off"
                                    >Write off</ng-option
                                >
                                <ng-option value="Interest Concession"
                                    >Interest Concession</ng-option
                                >
                                <ng-option value="Consolidation"
                                    >Consolidation</ng-option
                                >
                                <ng-option value="Private treaty sale"
                                    >Private treaty sale</ng-option
                                >
                                <ng-option value="Auction">Auction</ng-option>
                            </ng-select>
                        </div>
                    </div>
                </div>
                <!--        proposed remedial product end-->

                <!--        closure date start-->
                <div *ngIf="enablerest" class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">
                        Product Closure Date
                    </div>
                    <div *ngIf="!loader" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <div class="input-group">
                                <input
                                    type="text"
                                    placeholder="Proposed Product Closure Date"
                                    placement="top"
                                    class="form-control"
                                    formControlName="closuredate"
                                    #dp1="bsDatepicker"
                                    bsDatepicker
                                    [bsConfig]="{
                                        dateInputFormat: 'DD-MMM-YYYY'
                                    }"
                                    [minDate]="minxDate"
                                />
                                <div class="input-group-append">
                                    <button
                                        class="btn btn-outline-primary"
                                        (click)="dp1.toggle()"
                                        type="button"
                                    >
                                        <span
                                            ><i class="fa fa-calendar"></i>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--        closure date end-->

                <!--reason for changing start-->

                <div *ngIf="display" class="row" style="padding-top: 20px">
                    <div class="col-md-3">Reason For Changing</div>
                    <div class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <textarea
                                *ngIf="!loader"
                                [ngClass]="{ 'is-invalid': f.rchanging.errors }"
                                class="form-control is-valid"
                                formControlName="rchanging"
                                id="rchanging"
                                name="rchanging"
                                rows="2"
                            ></textarea>
                        </div>
                    </div>
                </div>

                <!--        reason for changing end-->

                <!--        promise to pay start-->

                <div
                    *ngIf="!f.ptp.disabled"
                    class="row"
                    style="padding-top: 20px"
                >
                    <div *ngIf="!f.ptp.disabled" class="col-md-3">
                        Promise to pay
                    </div>
                    <div *ngIf="!f.ptp.disabled" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                (ngModelChange)="
                                    changePtp(actionForm.value.ptp)
                                "
                                formControlName="ptp"
                                id="ptp"
                                placeholder="Select PTP"
                            >
                                <ng-option
                                    *ngFor="let p of ptp"
                                    [value]="p.id"
                                    >{{ p.name }}</ng-option
                                >
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        promise to pay end-->

                <!--        promise type start-->

                <div
                    *ngIf="!f.ptptype.disabled"
                    class="row"
                    style="padding-top: 20px"
                >
                    <div *ngIf="!f.ptptype.disabled" class="col-md-3">
                        Promise type
                    </div>
                    <div *ngIf="!f.ptptype.disabled" class="col-md-9">
                        <div class="col-md-12">
                            <div class="form-group row">
                                <div class="col-xl-6">
                                    <!--                  <form-->
                                    <!--                    #ptpForm="ngForm"-->
                                    <!--                    (ngSubmit)="ptpfunc(ptpForm)"-->
                                    <!--                    autocomplete="off"-->
                                    <!--                    novalidate-->
                                    <!--                  >-->
                                    <div class="form-group row">
                                        <label>Promise Amount:</label>
                                        <input
                                            [ngClass]="{
                                                'is-invalid': f.ptpamount.errors
                                            }"
                                            class="form-control"
                                            name="ptpamount"
                                            formControlName="ptpamount"
                                            placeholder="ptp amount"
                                            type="number"
                                            required
                                        />
                                    </div>

                                    <div class="form-group row">
                                        <div class="col-md-12">
                                            <label>Payment Method:</label>
                                            <ng-select
                                                [ngClass]="{
                                                    'is-invalid':
                                                        f.paymode.errors
                                                }"
                                                formControlName="paymode"
                                                placeholder="Select Payment Method"
                                                id="paymode"
                                            >
                                                <ng-option value="Cash"
                                                    >Cash</ng-option
                                                >
                                                <ng-option value="Cheque"
                                                    >Cheque</ng-option
                                                >
                                                <ng-option
                                                    value="Mobile Transfer"
                                                    >Mobile Transfer</ng-option
                                                >
                                                <ng-option value="Bank Transfer"
                                                    >Bank Transfer</ng-option
                                                >
                                            </ng-select>
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <div class="col-md-12">
                                            <label>PTP Date:</label>
                                            <div class="input-group">
                                                <input
                                                    #d="bsDatepicker"
                                                    [minDate]="minDate"
                                                    class="form-control"
                                                    name="ptpdate"
                                                    bsDatepicker
                                                    id="ptpdate"
                                                    formControlName="ptpdate"
                                                    type="text"
                                                    placement="left"
                                                    placeholder="yyyy-mm-dd"
                                                    required
                                                />

                                                <div class="input-group-append">
                                                    <button
                                                        (click)="d.toggle()"
                                                        class="btn btn-outline-primary"
                                                        type="button"
                                                    >
                                                        <span
                                                            ><i
                                                                class="fa fa-calendar"
                                                            ></i>
                                                        </span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button
                                        *ngIf="!edit"
                                        class="mb-1 mr-1 btn btn-sm btn-warning"
                                        type="button"
                                        (click)="ptpfunc()"
                                    >
                                        Add
                                    </button>
                                    <!--          (click)="updateptp(ptp)"-->
                                    <button
                                        *ngIf="edit"
                                        class="mb-1 mr-1 btn btn-sm btn-outline-warning col-form-label"
                                        type="button"
                                    >
                                        Update
                                    </button>
                                    <!--          (click)="cancel()"-->
                                    <button
                                        *ngIf="edit"
                                        class="mb-1 mr-1 btn btn-sm btn-outline-danger col-form-label"
                                        type="button"
                                    >
                                        Cancel
                                    </button>
                                    <!--                  </form>-->
                                </div>
                                <div class="col-xl-6">
                                    <table class="table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Accnumber</th>
                                                <th>Ptp amount</th>
                                                <th>Ptp date</th>
                                                <th>Payment Mode</th>
                                                <th>Owner</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr
                                                *ngFor="
                                                    let p of ptps
                                                        | paginate
                                                            : {
                                                                  itemsPerPage: 5,
                                                                  currentPage: p
                                                              }
                                                "
                                            >
                                                <td>
                                                    <strong>{{
                                                        p.accnumber
                                                    }}</strong>
                                                </td>
                                                <td>{{ p.ptpamount }}</td>
                                                <td>{{ p.ptpdate }}</td>
                                                <td>{{ p.paymethod }}</td>
                                                <td>{{ p.owner }}</td>
                                                <td>
                                                    <button
                                                        (click)="deleteptp(p)"
                                                        class="btn btn-outline-danger btn-sm"
                                                    >
                                                        <i
                                                            class="fas fa-trash-alt"
                                                        ></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!--                  <button-->
                                <!--                    (click)="saveallptps()"-->
                                <!--                    type='button'-->
                                <!--                    [disabled]="!isptptosave"-->
                                <!--                    class="btn btn-block btn-outline-success"-->
                                <!--                  >-->
                                <!--                    Save all Promises-->
                                <!--                  </button>-->

                                <!--                x6 end-->
                            </div>
                        </div>
                    </div>
                </div>

                <!--        promise type end-->

                <!--        promise date-->

                <!--        <div *ngIf="!f.ptpdate.disabled" class="row" style="padding-top: 20px">-->
                <!--          <div *ngIf="!f.ptpdate.disabled" class="col-md-3">  Promise date</div>-->
                <!--          <div *ngIf="!f.ptpdate.disabled" class="col-md-9">-->
                <!--            <div class="col-md-12">-->
                <!--              <div class="input-group">-->
                <!--                  <input-->
                <!--                    #p="bsDatepicker"-->
                <!--                    [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"-->
                <!--                    [minDate]="minxDate"-->
                <!--                    bsDatepicker-->
                <!--                    class="form-control"-->
                <!--                    formControlName="ptpdate"-->
                <!--                    id="ptpdate"-->
                <!--                    name="ptpdate"-->
                <!--                    placeholder="yyyy-mm-dd"-->
                <!--                    placement="left"-->
                <!--                    type="text"-->
                <!--                  />-->

                <!--                <div class="input-group-append">-->
                <!--                  <button-->
                <!--                    (click)="p.toggle()"-->
                <!--                    class="btn btn-outline-primary"-->
                <!--                    type="button"-->
                <!--                  >-->
                <!--                    <span><i class="fa fa-calendar"></i> </span>-->
                <!--                  </button>-->
                <!--                </div>-->
                <!--              </div>-->
                <!--            </div>-->
                <!--          </div>-->
                <!--        </div>-->

                <!--        promise date-->

                <!--        cmd status start-->

                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">CMD status</div>
                    <div *ngIf="!loader" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                *ngIf="!loader"
                                [ngClass]="{ 'is-invalid': f.cmdstatus.errors }"
                                formControlName="cmdstatus"
                                id="cmdstatus"
                                [loading]="cmdloading"
                                placeholder="Please Select"
                            >
                                <ng-option
                                    *ngFor="let cmd of cmdstatus"
                                    [value]="cmd.cmdstatus"
                                    >{{ cmd.cmdstatus }}</ng-option
                                >
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        cmd status end-->

                <!--&lt;!&ndash;payment mode start&ndash;&gt;-->

                <!--        <div class="row" style="padding-top: 20px">-->
                <!--          <div *ngIf="!f.paymode.disabled" class="col-md-3">Payment mode</div>-->
                <!--          <div *ngIf="!f.paymode.disabled" class="col-md-9">-->
                <!--            <div class="col-md-12">-->
                <!--              <label for="paymode"></label-->
                <!--              ><select-->
                <!--              [ngClass]="{ 'is-invalid': f.paymode.errors }"-->
                <!--              class="form-control"-->
                <!--              formControlName="paymode"-->
                <!--              id="paymode"-->
                <!--              name="paymode"-->
                <!--            >-->
                <!--              <option value="">Please select</option>-->
                <!--              <option>Cash</option>-->
                <!--              <option>Cheque</option>-->
                <!--              <option>Mobile Transfer</option>-->
                <!--              <option>Bank Transfer</option>-->
                <!--            </select>-->
                <!--            </div>-->
                <!--          </div>-->
                <!--        </div>-->

                <!--&lt;!&ndash;        payment mode end&ndash;&gt;-->

                <!--        route for review start-->

                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">Route for review</div>
                    <div *ngIf="!loader" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <ng-select
                                *ngIf="!loader"
                                formControlName="route"
                                id="route"
                                placeholder="Please Select"
                            >
                                <ng-option
                                    *ngFor="let r of reviewers"
                                    [value]="r.username"
                                    >{{ r.firstname }} {{ r.lastname }}
                                    {{ r.surname }}
                                </ng-option>
                            </ng-select>
                        </div>
                    </div>
                </div>

                <!--        route for review end-->

                <!--        review date start-->

                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">Review date</div>
                    <div *ngIf="!loader" class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                            ></ngx-skeleton-loader>
                            <div *ngIf="!loader" class="input-group">
                                <input
                                    #dp="bsDatepicker"
                                    [bsConfig]="{
                                        dateInputFormat: 'DD-MMM-YYYY'
                                    }"
                                    [minDate]="minxDate"
                                    bsDatepicker
                                    class="form-control"
                                    formControlName="reviewdate"
                                    id="review"
                                    placeholder="Review date"
                                    placement="top"
                                    type="text"
                                />
                                <div class="input-group-append">
                                    <button
                                        (click)="dp.toggle()"
                                        class="btn btn-outline-primary"
                                        type="button"
                                    >
                                        <span
                                            ><i class="fa fa-calendar"></i>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--        review date end-->

                <div class="form-group row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">
                        <div
                            *ngIf="!loader"
                            class="checkbox checkbox-css checkbox-inline"
                        >
                            <input
                                [checked]="false"
                                formControlName="callbackscheduleflag"
                                id="callbackscheduleflag"
                                name="callbackscheduleflag"
                                type="checkbox"
                                (click)="enablecallback($event)"
                            />
                            <label for="callbackscheduleflag"
                                >Set Callback schedule</label
                            >
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="col-md-12">
                            <div class="input-group">
                                <input
                                    [owlDateTimeTrigger]="dt2"
                                    [owlDateTime]="dt2"
                                    placeholder="Schedule Date Time"
                                    class="form-control"
                                    [min]="min"
                                    [ngClass]="{
                                        'is-invalid': f.scheduledate.errors
                                    }"
                                    formControlName="scheduledate"
                                />
                                <owl-date-time #dt2></owl-date-time>
                                <div class="input-group-append">
                                    <span [owlDateTimeTrigger]="dt2"
                                        ><button
                                            class="btn btn-outline-primary"
                                            type="button"
                                        >
                                            <i
                                                class="fa fa-calendar"
                                            ></i></button
                                    ></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" style="padding-top: 20px">
                    <div *ngIf="!loader" class="col-md-3">Collector note</div>

                    <div class="col-md-9">
                        <div class="col-md-12">
                            <ngx-skeleton-loader
                                *ngIf="loader"
                                [theme]="{
                                    'border-radius': '5px',
                                    height: '100px'
                                }"
                            ></ngx-skeleton-loader>
                            <textarea
                                *ngIf="!loader"
                                [ngClass]="{
                                    'is-invalid': f.collectornote.errors
                                }"
                                class="form-control is-valid"
                                formControlName="collectornote"
                                id="collectornote"
                                name="collectornote"
                                rows="3"
                            ></textarea>

                            <p
                                *ngIf="f.collectornote.errors?.minlength"
                                class="text-danger"
                            >
                                minimum of five(5) characters is required
                            </p>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <!--<div class="col-md-3 col-form-label">
            <div class="checkbox c-checkbox form-check-inline">
              <label>
                <input type="checkbox" [checked]="false" name="ptpemail" id="ptpemail" name="ptpemail"
                  formControlName="ptpemail" />
                Send PTP Reminder email <span class="fa fa-check"></span></label>
            </div>
            <div class="">
              <input type="text" name="toemail" id="toemail" name="toemail" class="form-control"
                formControlName="toemail" placeholder="Customer email" />
            </div>
          </div>-->

                    <div class="col-md-3 col-form-label">
                        <ngx-skeleton-loader
                            *ngIf="loader"
                        ></ngx-skeleton-loader>
                        <div
                            *ngIf="!loader && !f.ptpsms.disabled"
                            class="checkbox checkbox-css checkbox-inline"
                        >
                            <input
                                [checked]="false"
                                formControlName="ptpsms"
                                id="ptpsms"
                                name="ptpsms"
                                type="checkbox"
                            />
                            <label for="ptpsms">Send PTP Reminder SMS</label>
                        </div>
                        <div *ngIf="!f.ptpsmsnumber.disabled" class="">
                            <label for="ptpsmsnumber"></label>
                            <input
                                class="form-control"
                                formControlName="ptpsmsnumber"
                                id="ptpsmsnumber"
                                name="ptpsmsnumber"
                                placeholder="Customer Tel."
                                type="text"
                            />
                        </div>
                    </div>

                    <div class="col-md-3 col-form-label">
                        <ngx-skeleton-loader
                            *ngIf="loader"
                        ></ngx-skeleton-loader>
                        <div
                            *ngIf="!loader"
                            class="checkbox checkbox-css checkbox-inline"
                        >
                            <input
                                [checked]="false"
                                formControlName="flag"
                                id="flag"
                                name="flag"
                                type="checkbox"
                            />
                            <label for="flag">Flag this Note</label>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="!showit">
                <ngx-skeleton-loader *ngIf="loader"></ngx-skeleton-loader>
                <button
                    *ngIf="!loader"
                    [disabled]="actionForm.invalid"
                    class="btn btn-sm btn-primary"
                    id="submit"
                    type="submit"
                >
                    <i class="fa fa-dot-circle-o"></i> Submit
                </button>
                <button
                    (click)="reset()"
                    *ngIf="!loader"
                    class="btn btn-sm btn-danger"
                    id="reset"
                    type="reset"
                >
                    <i class="fa fa-ban"></i> Reset
                </button>
            </div>
        </form>
        <!--<pre>{{actionForm.valid | json}}</pre>
    <pre>{{actionForm.value | json}}</pre>-->
    </div>

    <!--  <ngx-smart-modal #myModal [dismissable]="false" identifier="myModal">-->
    <!--    <div class="modal-header">-->
    <!--      <h4 class="modal-title">Mulptiple PTP</h4>-->
    <!--    </div>-->
    <!--    <div class="card-body">-->
    <!--      <div class="row">-->
    <!--        <div class="col-md-4">-->
    <!--          <form-->
    <!--            #ptpForm="ngForm"-->
    <!--            (ngSubmit)="ptpfunc(ptpForm)"-->
    <!--            autocomplete="off"-->
    <!--            novalidate-->
    <!--          >-->
    <!--            <div class="form-group">-->
    <!--              <label>Promise Amount:</label>-->
    <!--              <label>-->
    <!--                <input-->
    <!--                  #ptpamount="ngModel"-->
    <!--                  [(ngModel)]="ptpmultiple.ptpamount"-->
    <!--                  [ngClass]="{ 'is-invalid': ptpamount.errors }"-->
    <!--                  class="form-control"-->
    <!--                  name="ptpamount"-->
    <!--                  placeholder="ptp amount"-->
    <!--                  required-->
    <!--                />-->
    <!--              </label>-->
    <!--            </div>-->
    <!--            <div class="form-group">-->
    <!--              <label>Promise Date:</label>-->
    <!--              <div class="input-group">-->

    <!--                  <input-->
    <!--                    #d="ngbDatepicker"-->
    <!--                    [(ngModel)]="ptpmultiple.ptpdate"-->
    <!--                    [minDate]="minDate"-->
    <!--                    class="form-control"-->
    <!--                    name="ptpdate"-->
    <!--                    ngbDatepicker-->
    <!--                    placeholder="yyyy-mm-dd"-->
    <!--                    required-->
    <!--                  />-->
    <!--                <div class="input-group-append">-->

    <!--                    <button-->
    <!--                      (click)="d.toggle()"-->
    <!--                      class="btn btn-outline-primary"-->
    <!--                      type="button"-->
    <!--                    >-->
    <!--                      <span><i class="fa fa-calendar"></i> </span>-->
    <!--                    </button>-->

    <!--                </div>-->
    <!--              </div>-->
    <!--            </div>-->
    <!--            <button-->
    <!--              *ngIf="!edit"-->
    <!--              [disabled]="!ptpForm.valid"-->
    <!--              class="btn btn-sm btn-outline-primary"-->
    <!--              class="mb-1 mr-1 btn btn-sm btn-outline-warning col-form-label"-->
    <!--              type="submit"-->
    <!--            >-->
    <!--              Add-->
    <!--            </button>-->
    <!--            &lt;!&ndash;          (click)="updateptp(ptp)"&ndash;&gt;-->
    <!--            <button-->
    <!--              *ngIf="edit"-->
    <!--              [disabled]="ptpForm.invalid"-->
    <!--              class="mb-1 mr-1 btn btn-sm btn-outline-warning col-form-label"-->
    <!--              type="button"-->
    <!--            >-->
    <!--              Update-->
    <!--            </button>-->
    <!--            &lt;!&ndash;          (click)="cancel()"&ndash;&gt;-->
    <!--            <button-->
    <!--              *ngIf="edit"-->
    <!--              class="mb-1 mr-1 btn btn-sm btn-outline-danger col-form-label"-->
    <!--              type="button"-->
    <!--            >-->
    <!--              Cancel-->
    <!--            </button>-->
    <!--          </form>-->
    <!--        </div>-->
    <!--        <div class="col-md-8">-->
    <!--          <table class="table">-->
    <!--            <thead>-->
    <!--              <tr>-->
    <!--                <th>Accnumber</th>-->
    <!--                <th>Ptp amount</th>-->
    <!--                <th>Ptp date</th>-->
    <!--                <th>Payment Mode</th>-->
    <!--                <th>owner</th>-->
    <!--                <th></th>-->
    <!--              </tr>-->
    <!--            </thead>-->
    <!--            <tbody>-->
    <!--              <tr-->
    <!--                *ngFor="-->
    <!--                  let p of ptps | paginate: { itemsPerPage: 5, currentPage: p }-->
    <!--                "-->
    <!--              >-->
    <!--                <td>-->
    <!--                  <strong>{{ p.accnumber }}</strong>-->
    <!--                </td>-->
    <!--                <td>{{ p.ptpamount }}</td>-->
    <!--                <td>{{ p.ptpdate }}</td>-->
    <!--                <td>payment mode</td>-->
    <!--                <td>{{ p.owner }}</td>-->
    <!--                <td>-->
    <!--                  <button-->
    <!--                    (click)="deleteptp(p)"-->
    <!--                    class="btn btn-outline-danger btn-sm"-->
    <!--                  >-->
    <!--                    <i class="fas fa-trash-alt"></i>-->
    <!--                  </button>-->
    <!--                </td>-->
    <!--              </tr>-->
    <!--            </tbody>-->
    <!--          </table>-->
    <!--          &lt;!&ndash;<pagination-controls (pageChange)="p = $event"></pagination-controls>&ndash;&gt;-->
    <!--          <button-->
    <!--            (click)="saveallptps()"-->
    <!--            (click)="myModal.close()"-->
    <!--            [disabled]="!isptptosave"-->
    <!--            class="btn btn-block btn-outline-success"-->
    <!--          >-->
    <!--            Save all Promises-->
    <!--          </button>-->
    <!--        </div>-->
    <!--      </div>-->
    <!--    </div>-->
    <!--    <div class="modal-footer">-->
    <!--      <button-->
    <!--        (click)="myModal.close()"-->
    <!--        class="btn btn-outline-darck"-->
    <!--        type="button"-->
    <!--      >-->
    <!--        Close-->
    <!--      </button>-->
    <!--    </div>-->
    <!--  </ngx-smart-modal>-->
</app-panel>

<!--start of ipf cancellation-->

<app-panel [hidden]="!showit">
    <div [hidden]="!showit" class="col-md-3">
        <div class="row">
            <button
                (click)="backtocollector()"
                class="btn btn-sm btn-success"
                type="button"
            >
                <i class="fas fa-arrow-circle-left"></i> Back to Collector
                Activity
            </button>
        </div>
    </div>

    <form #ipfletterForm="ngForm">
        <div class="card-header">
            <strong>Account Details</strong>
        </div>
        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Account Number</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #accnumber="ngModel"
                        [ngClass]="{ 'is-invalid': accnumber.invalid }"
                        [(ngModel)]="ipfcanceldata.ACCNUMBER"
                        [disabled]="false"
                        autocomplete="off"
                        class="form-control"
                        id="accnumber"
                        value="{{ ipfcanceldata.ACCNUMBER }}"
                        name="accnumber"
                        required
                    />
                </div>
            </div>
            <div class="col-md-3">Customer Number</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #custnumber="ngModel"
                        [(ngModel)]="ipfcanceldata.CUSTNUMBER"
                        [ngClass]="{ 'is-invalid': custnumber.invalid }"
                        required
                        class="form-control"
                        id="custnumber"
                        name="custnumber"
                        value="{{ ipfcanceldata.CUSTNUMBER }}"
                    />
                </div>
            </div>
        </div>

        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Customer Name</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #clientname="ngModel"
                        name="clientname"
                        [ngClass]="{ 'is-invalid': clientname.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.CUSTNAME"
                        value="{{ ipfcanceldata.CUSTNAME }}"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="col-md-3">Email Address</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #emailaddress="ngModel"
                        [ngClass]="{ 'is-invalid': emailaddress.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.EMAILADDRESS"
                        value="{{ ipfcanceldata.EMAILADDRESS }}"
                        class="form-control"
                        id="emailaddress"
                        name="emailaddress"
                    />
                </div>
            </div>
        </div>

        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Phone Number</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #telnumber="ngModel"
                        [ngClass]="{ 'is-invalid': telnumber.invalid }"
                        required
                        name="telnumber"
                        [(ngModel)]="
                            ipfcanceldata.TELNUMBER || ipfcanceldata.CELNUMBER
                        "
                        value="{{
                            ipfcanceldata.TELNUMBER || ipfcanceldata.CELNUMBER
                        }}"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="col-md-3">Product Name</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #productcode="ngModel"
                        [ngClass]="{ 'is-invalid': productcode.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.PRODUCTCODE"
                        class="form-control"
                        id="productname"
                        name="productname"
                    />
                </div>
            </div>
        </div>

        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Policy Amount</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #policyamount="ngModel"
                        [ngClass]="{ 'is-invalid': policyamount.invalid }"
                        required
                        [(ngModel)]="
                            ipfcanceldata.policyamount ||
                            ipfcanceldata.ARREARSAMOUNT
                        "
                        name="policyamount"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="col-md-3">Amount in Arrears</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #totalarrears="ngModel"
                        [ngClass]="{ 'is-invalid': totalarrears.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.ARREARSAMOUNT"
                        class="form-control"
                        id="amntinarrears"
                        name="amntinarrears"
                    />
                </div>
            </div>
        </div>

        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Days in Arrears</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #daysinarr="ngModel"
                        [ngClass]="{ 'is-invalid': daysinarr.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.DAYSINARR"
                        name="daysinarr"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="col-md-3">BranchName</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #branchname="ngModel"
                        [ngClass]="{ 'is-invalid': branchname.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.BRANCHNAME"
                        class="form-control"
                        id="branchname"
                        name="branchname"
                    />
                </div>
            </div>
        </div>

        <div class="row" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">Policy Number</div>
            <div class="col-md-3">
                <div class="col-md-12">
                    <input
                        #policynumber="ngModel"
                        [ngClass]="{ 'is-invalid': policynumber.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.POLICYNUMBER"
                        name="policynumber"
                        class="form-control"
                    />
                </div>
            </div>
        </div>

        <div class="form-group row m-b-15" style="padding-top: 20px">
            <div class="col-xl-2 col-md-3">With Asset Finance</div>
            <div class="col-md-9">
                <div class="radio radio-css radio-inline" id="yes">
                    <input
                        #waf="ngModel"
                        (change)="hasassetf($event)"
                        [(ngModel)]="ipfcanceldata.waf"
                        class="form-check-input"
                        id="inlineRadio3"
                        name="assetradio"
                        type="radio"
                        value="yes"
                    />
                    <label class="form-check-label" for="inlineRadio3"
                        >Yes</label
                    >
                </div>
                <div class="radio radio-css radio-inline" id="no">
                    <input
                        #waf="ngModel"
                        (change)="hasassetf($event)"
                        [(ngModel)]="ipfcanceldata.waf"
                        class="form-check-input"
                        id="inlineRadio4"
                        name="assetradio"
                        type="radio"
                        value="no"
                    />
                    <label class="form-check-label" for="inlineRadio4"
                        >No</label
                    >
                </div>
                <p *ngIf="withasset" class="text-danger">
                    <b>You cannot cancel an IPF with Asset Finance</b>
                </p>
                <!--                      <div *ngIf="celnumber.valid || emailaddress.valid" class="valid-feedback"></div>-->
            </div>
        </div>

        <div *ngIf="!withasset">
            <!--Reason for Default start-->

            <div class="row" style="padding-top: 20px">
                <div class="col-md-3">Reason for default</div>
                <div class="col-md-9">
                    <div class="col-md-12">
                        <!--              <p    placement="top" ngbTooltip="This is Disabled. Check the box to edit this"   [closeDelay]="500">&nbsp;</p>-->
                        <ng-select
                            #ipfreason="ngModel"
                            [ngClass]="{ 'is-invalid': ipfreason.invalid }"
                            required
                            [(ngModel)]="reason1"
                            name="ipfreason"
                            (change)="onChangeipfExcuse($event, $event[0].id)"
                            id="ipfreason"
                            placeholder="Select Reason"
                        >
                            <ng-option
                                *ngFor="let thing of mainReason"
                                [value]="[{ ex: thing.excuse, id: thing.id }]"
                            >
                                {{ thing.excuse }}</ng-option
                            >
                        </ng-select>
                    </div>
                </div>
            </div>

            <!--        Reason for Default end-->

            <!--        Reason for Default Detailed Start-->

            <div class="row" style="padding-top: 20px">
                <div class="col-md-3">Detail Reason for Default</div>
                <div class="col-md-9">
                    <div class="col-md-12">
                        <ng-select
                            #ipfreasondetails="ngModel"
                            [ngClass]="{
                                'is-invalid': ipfreasondetails.invalid
                            }"
                            required
                            [(ngModel)]="reason2"
                            (change)="onChangeipfExcuseDetails($event)"
                            name="ipfreasondetails"
                            id="ipfreasondetails"
                            placeholder="Select Reason Details"
                        >
                            <ng-option
                                *ngFor="let exdtls of subReason"
                                [value]="[
                                    {
                                        exd: exdtls.excusedetails,
                                        id: exdtls.excuseid
                                    }
                                ]"
                                >{{ exdtls.excusedetails }}</ng-option
                            >
                        </ng-select>
                    </div>
                </div>
            </div>

            <!--        Reason for Default Detailed end-->

            <div class="card-header">
                <strong>IPF Cancellation Details </strong>
                <!--      <button (click)="CollectoractionSteps()" class="btn btn-primary">SHOW ME STEPS</button>-->
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Date Cancellation Issued</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            ngModel
                            [bsConfig]="{
                                isAnimated: true,
                                dateInputFormat: 'DD-MMM-YYYY'
                            }"
                            [(ngModel)]="bsValue"
                            bsDatepicker
                            class="form-control"
                            id="dci"
                            placeholder="Date Issued"
                            [ngClass]="{
                                'is-invalid': ipfreasondetails.invalid
                            }"
                            required
                            placement="top"
                            name="dci"
                            type="text"
                        />
                    </div>
                </div>
                <div class="col-md-3">Issued By</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #issuedby="ngModel"
                            ngModel
                            value="{{ username }}"
                            [ngClass]="{ 'is-invalid': issuedby.invalid }"
                            required
                            readonly
                            [(ngModel)]="username"
                            class="form-control"
                            id="issuedby"
                            name="issuedby"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">User</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #user="ngModel"
                            ngModel
                            name="user"
                            value="{{ username }}"
                            [ngClass]="{ 'is-invalid': user.invalid }"
                            required
                            [(ngModel)]="username"
                            class="form-control"
                        />
                    </div>
                </div>
                <div class="col-md-3">Policy Start Date</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #psdate="ngModel"
                            ngModel
                            [(ngModel)]="ipfcanceldata.POLICYSTARTDATE"
                            #psd="bsDatepicker"
                            required
                            [ngClass]="{ 'is-invalid': psdate.invalid }"
                            [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                            bsDatepicker
                            class="form-control"
                            id="psd"
                            placeholder="Policy Start Date"
                            name="psdate"
                            placement="top"
                            type="text"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Insurance Company</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #insuco="ngModel"
                            ngModel
                            name="insuco"
                            [ngClass]="{ 'is-invalid': insuco.invalid }"
                            required
                            [(ngModel)]="ipfcanceldata.INSURANCE_COMPANY"
                            class="form-control"
                        />
                    </div>
                </div>
                <div class="col-md-3">Insurance Email</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #insuemail="ngModel"
                            [ngClass]="{ 'is-invalid': insuemail.invalid }"
                            required
                            ngModel
                            [(ngModel)]="ipfcanceldata.INSURANCE_EMAIL"
                            class="form-control"
                            id="insuemail"
                            name="insuemail"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Broker</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #broker="ngModel"
                            [ngClass]="{ 'is-invalid': broker.invalid }"
                            required
                            name="broker"
                            ngModel
                            [(ngModel)]="ipfcanceldata.BROKER_AGENT"
                            class="form-control"
                        />
                    </div>
                </div>
                <div class="col-md-3">Insurance Address</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #insuaddress="ngModel"
                            [ngClass]="{ 'is-invalid': insuaddress.invalid }"
                            required
                            ngModel
                            [(ngModel)]="ipfcanceldata.INSUADDRESS"
                            class="form-control"
                            id="insuaddress"
                            name="insuaddress"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Loan Start Date</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #loanstartdate="ngModel"
                            [ngClass]="{ 'is-invalid': loanstartdate.invalid }"
                            required
                            ngModel
                            [(ngModel)]="ipfcanceldata.LOANSTARTDATE"
                            #lsd="bsDatepicker"
                            [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                            bsDatepicker
                            class="form-control"
                            id="lsd"
                            placeholder="Loan Start Date"
                            name="loanstartdate"
                            placement="top"
                            type="text"
                        />
                    </div>
                </div>
                <div class="col-md-3">Policy EndDate</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #policyenddate="ngModel"
                            [ngClass]="{ 'is-invalid': policyenddate.invalid }"
                            required
                            ngModel
                            [(ngModel)]="ipfcanceldata.POLICYENDDATE"
                            #ped="bsDatepicker"
                            [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                            bsDatepicker
                            class="form-control"
                            id="ped"
                            placeholder="Policy End Date"
                            name="policyenddate"
                            placement="top"
                            type="text"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-md-3">
                    <div class="col-md-12">
                        <button
                            (click)="calculaterefund(ipfletterForm)"
                            class="btn btn-sm btn-primary"
                            id="calculaterefund"
                            type="button"
                        >
                            <i class="fa fa-calculator"></i> Calculate Refund
                            Amount
                        </button>
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Days Utilized</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #daysutilized="ngModel"
                            [ngClass]="{ 'is-invalid': daysutilized.invalid }"
                            required
                            [ngModel]="ipfmodel.daysutilized"
                            name="daysutilized"
                            class="form-control"
                        />
                    </div>
                </div>
                <div class="col-md-3">Days Unutilized</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #daysunutilized="ngModel"
                            [ngClass]="{ 'is-invalid': daysunutilized.invalid }"
                            required
                            [ngModel]="ipfmodel.daysunutilized"
                            class="form-control"
                            id="daysunt"
                            name="daysunt"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-xl-2 col-md-3">Refund Amount</div>
                <div class="col-md-3">
                    <div class="col-md-12">
                        <input
                            #refundamount="ngModel"
                            [ngClass]="{ 'is-invalid': refundamount.invalid }"
                            required
                            [(ngModel)]="ipfmodel.refund"
                            name="refundamount"
                            class="form-control"
                        />
                    </div>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-md-12">
                    <label>Cancellation Comments</label>
                    <label for="cancellationcomm"></label
                    ><textarea
                        minlength="5"
                        #cancellationcomm="ngModel"
                        [ngClass]="{ 'is-invalid': cancellationcomm.invalid }"
                        required
                        [(ngModel)]="ipfcanceldata.cancellationcomm"
                        class="form-control"
                        id="cancellationcomm"
                        name="cancellationcomm"
                        rows="3"
                    ></textarea>
                    <p
                        *ngIf="cancellationcomm?.errors?.minlength"
                        class="text-danger"
                    >
                        minimum of five(5) characters is required
                    </p>
                </div>
            </div>

            <div class="row" style="padding-top: 20px">
                <div class="col-md-3">
                    <div class="col-md-12">
                        <button
                            (click)="previewletter(ipfletterForm)"
                            class="btn btn-sm btn-primary"
                            id="previewcanceletter"
                            type="submit"
                        >
                            Preview Cancellation Letter
                        </button>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="col-md-12">
                        <button
                            (click)="processletter(ipfletterForm)"
                            [disabled]="ipfletterForm.invalid"
                            class="btn btn-sm btn-primary"
                            id="submitletter"
                            type="submit"
                        >
                            Submit
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</app-panel>
